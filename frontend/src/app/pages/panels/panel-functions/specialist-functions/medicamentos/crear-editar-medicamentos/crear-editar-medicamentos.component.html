@if (isLoading) {
<section>
    <p>Registrando Medicamento...</p>
    <app-loading-spinner></app-loading-spinner>
</section>
} @else {
<form [formGroup]="registerForm" (ngSubmit)="onRegisterMedicine()">
    <h2 *ngIf="!isEditing; else isEditingH2">FORMULARIO CREAR MEDICAMENTO</h2>
    <ng-template #isEditingH2>
        <h2>FORMULARIO EDITAR MEDICAMENTO</h2>
    </ng-template>
    <section class="form-first-row">
        <fieldset class="form-speciality-data">
            <legend>Datos medicamento</legend>
            <article class="name-field">
                <label for="name">Nombre</label>
                <input type="text" id="name" formControlName="nombre" [ngClass]="{'invalid':
                       registerForm.get('nombre').invalid && sendedAttempt }">
            </article>
            <article class="description-field">
                <section class="description-data">
                    <label for="description">Descripción</label>
                    <p><span
                            [class.description-overlimit]="descriptionLength > maxLength">{{descriptionLength}}</span>/{{maxLength}}
                        caracteres</p>
                </section>
                <quill-editor formControlName="descripcion" id="description" placeholder="Introduce una descripción..."
                    [modules]="quillConfig"
                    [ngClass]="{ 'invalid': registerForm.get('descripcion').invalid && sendedAttempt }"></quill-editor>
            </article>
        </fieldset>
    </section>
    @if (registerForm.invalid && sendedAttempt) {
    <section class="error-message">
        <h3>Por favor, rellena todos los campos correctamente:</h3>
        <ul>
            @if (registerForm.get('nombre').invalid) {
            <li>
                <strong>Nombre:</strong> Debe empezar por mayúscula y el resto de
                letras en minúsculas.
            </li>
            }

            @if (registerForm.get('descripcion').invalid) {
            <li>
                <strong>Descripción:</strong> Debe de tener una descripción y no superar los 120 caracteres.
            </li>
            }

        </ul>
    </section>
    } @else if (errores.length > 0) {
    <div class="error-message">
      <ul>
        <li *ngFor="let error of errores">{{ error }}</li>
      </ul>
    </div>
    }
    <section class="btn-section">
        <button type="submit" *ngIf="!isEditing; else isEditingBtn">Crear</button>
        <ng-template #isEditingBtn>
            <button type="submit">Editar</button>
        </ng-template>
        <button type="button" class="btn-cancel" (click)="onCancel()">Cancelar</button>
    </section>
</form>
}
