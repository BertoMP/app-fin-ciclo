<section class="header">
  <h2>Listado de Informes</h2>
</section>
<section class="filter-buttons">
  <article class="filters">
    <article class="init-date-filter">
      <label for="fechaInicio">Fecha inicio</label>
      <input type="date" id="fechaInicio" [(ngModel)]="fechaInicio" (blur)="updateFilters()">
    </article>
    <article class="end-date-filter">
      <label for="fechaFin">Fecha fin</label>
      <input type="date" id="fechaFin" [(ngModel)]="fechaFin" (blur)="updateFilters()">
    </article>
    <article class="per-page-filter">
      <label for="per-page">Items</label>
      <select2 id="per-page" [data]="perPageOptions" [value]="10" [(ngModel)]="perPage" (update)="updateFilters()"></select2>
    </article>
  </article>
</section>
@if (!dataLoaded) {
  <app-loading-spinner></app-loading-spinner>
} @else if (!informes.length) {
  @if (fechaInicio || fechaFin) {
    <section class="no-results">
      <p>No se encontraron resultados con esos criterios de búsqueda.</p>
      <figure>
        <img src="assets/img/search-not-found.png" alt="No se encontraron resultados">
      </figure>
    </section>
  } @else {
    <section class="no-results">
      <p>No se encontraron informes.</p>
    </section>
  }
} @else {
  <section class="name-download">
    @if (isPatient) {
      <p>Estos son tus informes, {{paciente}}</p>
    } @else {
      <p>Estos son los informes de {{paciente}}</p>
    }
  </section>
  <section class="informes-table">
    <div class="info">
      <small>Mostrando {{ resultMin }} - {{ resultMax }} de {{ totalItems }} informes.</small>
    </div>
    <div class="table-container">
      <table>
        <thead>
        <tr>
          <th scope="col">Fecha</th>
          <th scope="col">Especialidad</th>
          <th scope="col">Acción</th>
        </tr>
        </thead>
        <tbody>
        <ng-container *ngFor="let informe of (informes | paginate: { id: 'citasListPagination', itemsPerPage: itemsPerPage, currentPage: actualPage, totalItems: totalItems })">
          <tr>
            <td>{{informe.fecha}}</td>
            <td>{{informe.especialidad_nombre}}</td>
            <td>
              <button type="button" class="btn btn-primary"
                      routerLink="/mediapp/ver-informe/{{informe.informe_id}}">Ver</button>
            </td>
          </tr>
        </ng-container>
        </tbody>
      </table>
    </div>
    @if (previousPageUrl || nextPageUrl) {
      <div class="pagination">
        <pagination-controls
          (pageChange)="actualPage = $event; changePage(actualPage)"
          id="citasListPagination"
          maxSize="5"
          directionLinks="true"
          previousLabel="Anterior"
          nextLabel="Siguiente"
        ></pagination-controls>
      </div>
    }
  </section>
}
